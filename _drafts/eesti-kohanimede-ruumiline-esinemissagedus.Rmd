---
title: "Eesti kohanimede ruumiline esinemissagedus"
author: "Toomas Eilat"
date: "`r Sys.Date()`"
layout: post
---

```{r, echo=FALSE}
# Piltide asukoht
knitr::opts_chunk$set(fig.path='{{ site.url }}/img/eesti-kohanimede-ruumiline-esinemissagedus-')
```

```{r setup, include=FALSE}
# graafikute ja koodi seaded
# library(svglite)  # vajalik svg formaadis piltide salvestamiseks
knitr::opts_chunk$set(
    echo = FALSE, 
    message = FALSE,
    # dev = "svglite",
    dpi = 300,
    warning = FALSE,
    fig.cap = ""
)
```

```{r andmete laadimine}
library(extrafont)
library(dplyr)
library(stringr)
library(ggplot2)
library(readr)
library(scales)
library(ggthemes)
library(ggalt)
library(sp)
library(viridis)
library(gridExtra)

load("C:/Users/toomase/Dropbox/DataScience/R/kohanimed/output/algandmed.RData")
source("C:/Users/toomase/Dropbox/DataScience/R/kohanimed/R/eesti_hexabin.R")

```

## Mis?
Inspireerituna Moritz Stefaner'i [blogipostitusest](http://truth-and-beauty.net/experiments/ach-ingen-zell/) tegin Eesti [kohanimeregistri](http://xgis.maaamet.ee/knravalik/) baasil väikese analüüsi kohanimedes sisalduvate sõnade ruumilisest esinemissagedusest. Kohanimeregisteris on üle 155 000 kande: linnad, tänavad, järved, mäed, poolsaared, bussipeatused, talud jne. Sellest andmebaasist otsisin kohanimesid, mis sisaldavad mingit sõna, näiteks "mõis" ja kuvasin kõik vastavad asukohad kaardile. 
Tumesinine toon näitab suurt esinemissagedust, heleroheline väikest ning kollane seda, et piirkonnas vastavat sõna sisaldavaid kohanimesid pole.

```{r mois, fig.width = 8, fig.height = 6, fig.align = "center", message = FALSE, warning = FALSE}
eesti_hexabin("mõis")

```

See analüüs ei ole teaduslik ja ülimalt täpne lähenemine kohanimedele vaid pigem on eesmärk leida lihtsalt huvitavaid mustreid ja avastada Eestit uue nurga alt.

## Vastandid
Vaatasin kuidas jagunevad erinevad vastandid kohanimedes. 
```{r vastandid, fig.width = 10, fig.height = 18, fig.align = "center"}
suur <- eesti_hexabin("suur")
vaike <- eesti_hexabin("väike")
must <- eesti_hexabin("must")
valge <- eesti_hexabin("valge")
pikk <- eesti_hexabin("pikk")
luhike <- eesti_hexabin("lühike")
uus <- eesti_hexabin("uus")
vana <- eesti_hexabin("vana")

grid.arrange(suur, vaike, must, valge, pikk, luhike, uus, vana, ncol = 2, nrow = 4)
```


## Mõisad, kirikud, lossid ja talud

```{r mois_talu_kirik_loss, fig.width = 10, fig.height = 9, fig.align = "center"}
mois <- eesti_hexabin("mõis")
kirik <- eesti_hexabin("kirik")
loss <- eesti_hexabin("loss")
talu <- eesti_hexabin("talu")

grid.arrange(mois, talu, kirik, loss, ncol = 2, nrow = 2)
```
